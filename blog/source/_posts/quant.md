---
title: 从入门到放弃-量化投资学习笔记（一）
categories:
  - Quant
tags:
  - Quant
abbrlink: 13046
date: 2018-07-25 22:18:04
updated: 2018-08-04 22:47:04
---


## 一、量化投资介绍

### 有效市场假说

EMH的三种形式：

- 弱式有效市场假说（Weak-Form Market Efficiency）
- 半强式有效市场假说（Semi-Strong-Form Market Efficiency）
- 强式有效市场假说（Strong-Form Market Efficiency）

推论：

- 如果弱式有效市场假说成立，则股票价格的技术分析失去作用，基本分析还可能帮助投资者获得超额利润。
- 如果半强式有效假说成立，在市场中利用基本面分析则失去作用，内幕消息可能获得超额利润。
- 在强式有效市场中，没有任何方法能帮助投资者获得超额利润，即使基金和有内幕消息者也一样。

<!--more-->

### 主动投资的不足

人性中对于获利的贪婪和对于损失的恐惧是亘古不变的

### 理查德·塞勒（Richard Thaler）理论

- 禀赋效应：人们在决策过程中对利和害的权衡是不均衡的，对“避害”的考虑远大于对“趋利”的考虑
- 跨期选择：人类恰恰是不擅长做跨期决策的，大多数时候会做出短视冲动的选择
- 心理账户 & 储蓄理论：人在思考问题时，会在心里构建出分门别类的心理账户，分别进行计算

### 行为经济学

- 赚谁的钱：市场在某一特定时间内的无效性，或者说是别人犯的错误
- 赚什么钱：主动承担某种特定风险，继而获得承担该风险的风险溢价

### 主观投资与量化投资的区别 

只在于策略如何被制定以及如何被执行

### 收益率(return) 公式

$$ r_P = \beta_P  * r_B +\alpha_P $$

- P：投资组合portfolio
- B：业绩基准组合B
- $\beta_P$：P相对于B的beta系数，又称P的系统风险
- $\alpha_P$：反映了P对于B的超额收益能力，这部分收益与大盘的波动无关，这就是alpha的魅力

#### Alpha 的非常规定义：

在交易中关于持有头寸选择和买卖时机把握的技巧 

### 宽客(Quant)

![](http://os21ow86u.bkt.clouddn.com/quant1.png)

### 一个完整的量化交易系统

- 市场：买卖什么
- 逻辑：买卖思路
- 头寸规模：买卖多少
- 入市：何时买进
- 止损：何时退出亏损的头寸
- 离市：何时退出盈利的头寸



## 二、量化必备股票基础知识

### 交易决策过程

1. 数据
2. 价量时空仓
3. 指标
4. 信号
5. 买卖

### 分时图与K线图的数据处理

- 分时图上共有251个数据点

- K线图（蜡烛图）反应的是开高低收(Open/High/Low/Close)

- K线图数据（bars）是由Level1行情数据（ticks）经过格式解析、聚合处理成的。

- 正确地接收行情数据，并根据量化模型的需要累计出不同级别的分时和K线数据，是量化 

  一项基本功。

### 技术指标

基于行情数据，通过特定数学公式或模型计算得出的、用于辅助交易决策的数值序列。

分类：

1. 均线型：反映一段时间内的平均成本；具有一定的压力或支撑作用；MA、EXPMA、BBI...
2. 趋势型：适用于趋势类的行情；检测趋势的启动、延续，还有可能的转折；MACD、SAR、ASI、DMI...
3. 摆动型：适用于震荡类的行情；检测超买超卖、波动走势的可能转折点；KDJ、RSI、CCI、WR、BOLL...
4. 能量型：度量涨跌的力度，预示价格位移的可持续性；依据是“量在价先，量价配合”；OBV、VOL、VR...

#### MA-移动均线(Moving Average)

$$ MA10_k = \cfrac{1}{10} \sum_{i = k-9}^k {Price_i} (k=10\cdots n) $$

用Python计算MACD：

```python
import pandas as pd

# the data type of "close" is pd.Series
def calc_macd(close, long, short, mid):
    diff = close.ewm(span=short).mean()-close.ewm(span=long).mean()
    dea= diff.ewm(span=mid).mean()
    macd= (diff - dea) * 2
    return (diff, dea, macd)
```

#### KD-随机指数

$$ \%K = 100\times \cfrac{Close-min_n Low}{max_nHigh-min_nLow}  $$

$$\%D = MA(\%K,N)$$

#### RSI-相对强弱指数

$$RS = \cfrac{\sum_1^nMAX(Close-LC, 0)}{\sum_1^n|Close-LC|}$$

$$RSI = 100 - \cfrac{100}{1+RS}$$

#### 技术指标的应用技巧

1. 信号：价格突破/指标突破、均线交叉/指标交叉、顶背离/底背离
2. 用途：预警、确认、预测
3. 决策：趋势跟踪、高抛低吸
4. 动作：买入、卖出、观望

#### 技术指标的应用原则

客观看待，理性应用

- 扬长避短
  - 间接性、滞后性、钝化
  - 连续背离现象
  - 时间周期相关
- 综合判断
  - 靠单一指标解决问题不现实
  - 交叉验证，辅助决策
- 概率思维
  - 行情多变，市场不可预测
  - 量化即概率，大数定律

### 更多的交易决策依据

- 基本面：业绩表现、潜力大小、是否抗跌
- 资金面：大盘/板块资金流向、个股资金流向、主力大单的表现
- 技术面：趋势方向如何、涨跌空间大小、有无买卖信号
- 其他：市场情绪、利空/利多的消息、公告事件

### 集合竞价

#### 撮合交易原理

- 撮合交易是指交易所的计算机交易系统对买卖双方的交易指令进行配对的过程
- 撮合成交的前提是买入价大于或者等于卖出价：
  - 相等：“买入价/卖出价”作为成交价
  - 不等：“买入价、卖出价、前一成交价，取三者居中的那个价格”作为成交价
- 基本原则： 按价格优先、时间优先的原则进行

#### 集合竞价时间线

09:15~09:20：接受买卖申报，也可撤单申报

09:20~09:25：开盘集合竞价阶段，不接受撤单申报

09:25：产生（当日该股的）开盘价：按价格优先和时间优先的原则计算各价位的成交量，最后以最大成交量的价格作为成交价

09:25~09:30：只接受买卖申报，但不可撤单，也不做处理

09:30：进入正常交易（连续竞价）阶段

### 除权、复权

#### 除权/除息原因

1. 因为以下事件，每股对应的权益发生了变化
   - 分红：派息、送股、转股（转增）
   - 融资：配股
2. 为公平起见，需要对股价进行修正。该过程就是“除权/除息”

#### 复权原因

除权/除息使得股价（每股代表的权益）发生了跳变。为便于观察股价的正常波动，将扣除的权息再回补过去（修复股价的跳变），该过程就是“复权”。

#### 复权方式

- 前复权
- 后复权
- 定点复权
- 不复权

### 打新、配股

#### 打新股

- 所谓“打新”，是指个人或机构投资者用资金参与新股的申购，如果（配号）中签且预存资金充足的话，就买到了即将上市的股票
- 因为IPO通常折价发行，所以新上市的股票往往短期上涨的概率较大，所以如果打新成功，收益稳风险低，因此“打新申购”非常受投资者的青睐
- 温馨提示：两个交易所均配置有底仓；维持一定的底仓市值额度；风险意识

#### 配股

- 上市公司向原股东按其持股比例，以低于市价的某一特定价格配售一定数量新发行股票的融资行为
- 在股权登记日收市清算后仍持有该股，则自动享有配股权利；需在缴款期内参加配股，逾期不操作，即为放弃配股权利
- 一般配股价越低（也就是对老股东折让的幅度越大），参与配股越合算。但受除权和配股募资投向等影响，并不意味着稳赚不赔

### 公告研报社交媒体

是面向量化的非结构化数据处理基础。

#### 处理非结构化数据的相关技术：

- 渠道和获取：接口、抓取、购买
- 数据清洗、格式转换：网页、PDF、图片
- 分析、处理和存储：非结构化到半结构化/结构化：NLP、统计语言模型、规则
- 应用方式：独到视角、演进分析、建模

### 趋势分析和量价分析

趋势分析和量价分析是技术派量化的逻辑基础 。

#### 趋势分析

趋势即牛熊，需关注三个关系：

- 供需关系：趋势的动力来自于供需关系的不平衡
- 因果关系：趋势形成之前需要准备过程
- 努力和结果关系：成交量的增长没有使价格大幅增长，这是走势停止行为

#### 对支撑和压力的理解：

支撑：

- 在某个价位购买力超过了抛售压力，需求吸收了全部供应
- 当价格再次回到支撑位，反弹力度表明需求质量

压力：

- 某个价位抛售力量超过了购买力，供应超过了需求
- 当价格再次回到压力位，价格回落力度表明供应是否扩大

#### 量价时空

- 量：供应和需求投入的兵力
- 价：供应和需求当前的强弱
- 时：供应和需求拉锯的过程长度
- 空：供应和需求战场的广阔程度

#### 量价分析的核心问题

还是三个关系： 

- 供需关系：
  - 质量
  - 力量
- 因果关系：
  - 过程
  - 时空
- 努力和结果关系：
  - 显性
  - 隐性



### 参考书籍

- 《打开量化投资的黑箱》 

  Inside the Black'Box:A Simple Guide to Quantitative and High-Frequency Trading 

  里什•纳兰(Rishi K.Narang)  

- 《主动投资组合管理:创造高收益并控制风险的量化投资方法》 

  Active Portfolio Management: A Quantitative Approach for Providing Superior Returns and Controlling Risk (2th Edition) 

  理查德C.格林诺德(Richard C.Grinol) , 雷诺德N.卡恩(Ronald N.Kahn) , 李腾 (译者)

- 《威科夫操盘法》

  Wychkoff Trading Tools and Techniques 

  孟洪涛 （Edward Meng） 

- 《证券分析》 

  Security Analysis: Sixth Edition 

  本杰明•格雷厄姆 (Benjamin Graham) , 戴维•多德 (David L. Dodd)  